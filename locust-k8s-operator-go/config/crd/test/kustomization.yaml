# Kustomization for integration tests
# This generates a v1-only CRD without conversion webhook requirements.
# Integration tests use v1 API and don't need v2 conversion.
# E2E tests cover the full webhook/conversion functionality.
resources:
- base.yaml

patches:
# Make v1 the storage version and remove v2 for integration tests
- target:
    group: apiextensions.k8s.io
    version: v1
    kind: CustomResourceDefinition
    name: locusttests.locust.io
  patch: |-
    - op: replace
      path: /spec/versions/0/storage
      value: true
    - op: replace
      path: /spec/versions/0/deprecated
      value: false
    - op: remove
      path: /spec/versions/0/deprecationWarning
    - op: remove
      path: /spec/versions/1
